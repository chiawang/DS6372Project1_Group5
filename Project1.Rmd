---
title: "Project 1"
author: "Brandon, Queena"
date: "September 15, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown 
## Objective 1: Display the ability to build regression models using the skills and discussions from Unit 1 and 2.   
.	Provide interpretation of the regression model including hypothesis testing, interpretation of regression coefficients, and confidence intervals.  Practical vs Statistical significance.
Logistical Considerations.

.	Depending on the groups data set (number of predictors and complexity in your final model), it may make more sense to produce two models.  One model that may not be the absolute best for prediction, but would be good for interpretation and hypothesis testing.  Another model could achieve the opposite, high predictability but difficult in providing interpretation.  For smaller data sets it may not be required and one model can provide both.  Do what makes sense given your own data set and your own model building process.  

```{r read and analyse the data}
library(ggplot2)

## Read in the CSV file
kc_data_df <- read.csv(file="C:/Users/chiawa/DS6372Project1_Group5/kc_house_data.csv", header=TRUE, sep=",")

## Remove all the NAs
kc_cleanData_df <-kc_data_df[rowSums(is.na(kc_data_df)) == 0,]
pairs (~price + bedrooms + bathrooms + sqft_lot + zipcode + view + floors + sqft_living, data = kc_cleanData_df)

# Try a transformation with every relevant variable logged.

lprice <- log(kc_cleanData_df$price)
lbedrooms<-log(kc_cleanData_df$bedrooms)
lbathrooms<-log(kc_cleanData_df$bathrooms)
lsqft_lot<-log(kc_cleanData_df$sqft_lot)
lzipcode<-log(kc_cleanData_df$zipcode)
lview <- log(kc_cleanData_df$view)
lfloors<-log(kc_cleanData_df$floors)
lsqft_living<-log(kc_cleanData_df$sqft_living)

pairs (~lprice + lbedrooms + lbathrooms + lsqft_lot + lzipcode + lview + lfloors + lsqft_living, data = kc_cleanData_df)


sqrt_price <- sqrt(kc_cleanData_df$price)
sqrt_bedrooms<-sqrt(kc_cleanData_df$bedrooms)
sqrt_bathrooms<-sqrt(kc_cleanData_df$bathrooms)
sqrt_sqft_lot<-sqrt(kc_cleanData_df$sqft_lot)
sqrt_zipcode<-sqrt(kc_cleanData_df$zipcode)
sqrt_view <- sqrt(kc_cleanData_df$view)
sqrt_floors<-sqrt(kc_cleanData_df$floors)
sqrt_sqft_living<-sqrt(kc_cleanData_df$sqft_living)

#pairs (~sqrt_price + sqrt_bedrooms + sqrt_bathrooms + sqrt_sqft_lot + sqrt_zipcode + sqrt_view + sqrt_floors + sqrt_sqft_living, data = kc_cleanData_df)



## Number of Bedroom vs Price
qplot(kc_cleanData_df$bedrooms, kc_cleanData_df$price,  data=kc_cleanData_df)
cor.test(kc_cleanData_df$bedrooms, kc_cleanData_df$price)

## Number of Bathrooms vs Price
qplot(kc_cleanData_df$bathrooms, kc_cleanData_df$price,data=kc_cleanData_df)
cor.test(kc_cleanData_df$bathrooms, kc_cleanData_df$price)

## sqft_lot of Bedroom vs Price
qplot(kc_cleanData_df$sqft_lot, kc_cleanData_df$price,  data=kc_cleanData_df)
cor.test(kc_cleanData_df$sqft_lot, kc_cleanData_df$price)

## zipcode vs price
qplot(kc_cleanData_df$zipcode,  kc_cleanData_df$price,   data=kc_cleanData_df)
cor.test(kc_cleanData_df$zipcode, kc_cleanData_df$price)

## view of Bedroom vs Price
qplot(kc_cleanData_df$view, kc_cleanData_df$price,  data=kc_cleanData_df)
cor.test(kc_cleanData_df$view, kc_cleanData_df$price)

## floors vs price
qplot(kc_cleanData_df$floors,  kc_cleanData_df$price,   data=kc_cleanData_df)
cor.test(kc_cleanData_df$floors, kc_cleanData_df$price)

## sqft_living vs Price
qplot(kc_cleanData_df$sqft_living, kc_cleanData_df$price,  data=kc_cleanData_df)
cor.test(kc_cleanData_df$sqft_living, kc_cleanData_df$price)

## sqft_living vs Price
qplot(kc_cleanData_df$yr_built, kc_cleanData_df$price,  data=kc_cleanData_df)
cor.test(kc_cleanData_df$yr_built, kc_cleanData_df$price)
```

```{r model}
library(ggplot2)

## Read in the CSV file
kc_data_df <- read.csv(file="C:/Users/chiawa/DS6372Project1_Group5/kc_house_data.csv", header=TRUE, sep=",")

## Remove all the NAs
kc_cleanData_df <-kc_data_df[rowSums(is.na(kc_data_df)) == 0,]


kc_cleanData_df.lm <- lm(kc_cleanData_df$price ~ kc_cleanData_df$bathrooms + kc_cleanData_df$sqft_living , data = kc_cleanData_df)
summary(kc_cleanData_df.lm)

model_PI = predict(kc_cleanData_df.lm, interval="predict", newdata=kc_cleanData_df)
model_PI

```
```{r plotting the model fit}
library(ggplot2)

## Read in the CSV file
kc_data_df <- read.csv(file="C:/Users/chiawa/DS6372Project1_Group5/kc_house_data.csv", header=TRUE, sep=",")

## Remove all the NAs
kc_cleanData_df <-kc_data_df[rowSums(is.na(kc_data_df)) == 0,]
kc_cleanData_df.lm <- lm(kc_cleanData_df$price ~ kc_cleanData_df$bathrooms + kc_cleanData_df$sqft_living , data = kc_cleanData_df)

##plotting the model fit
par(mfrow=c(2,2))
plot(kc_cleanData_df.lm , which=c(1:3))

##Histogram with normal curve
##Store studentized residuals
studresbrain <- rstudent(kc_cleanData_df.lm )

##Histogram
hist(studresbrain, freq=FALSE, main="Distribution of Studentized Residuals",
xlab="Studentized Residuals", ylab="Density", ylim=c(0,0.5))

##Create range of x-values for normal curve
xfit2 <- seq(min(studresbrain)-1, max(studresbrain)+1, length=40)

##Generate values from the normal distribution at the specified values
yfit2 <- (dnorm(xfit2))

##Add the normal curve
lines(xfit2, yfit2, ylim=c(0,0.5))


```


## Including Plots

You can also embed plots, for example:

```{r correlation, echo=FALSE}
## Residual
plot(Airbnb_CleanData$price, Airbnb_CleanData.res, ylab = "Residuals", xlab="rental price", main = "The New York AirBnB")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
